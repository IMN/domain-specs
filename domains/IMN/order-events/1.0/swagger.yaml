info:
  description: IMN Core - Order Events
  version: '1.0'
  title: IMN - Order Events

x-beezup-ops:
  codeGenType: domain
  repo: IMN
  appRoot: IMN.Order.Events
  apiName: TBD
  namespace: IMN.Order.Events
  comment: |
    IMN.Order.Events
  using:
  - IMN.Schemas
  - IMN.Order.Schemas
  - BeezUP2.Framework.Processing
  - UserErrorMessage=BeezUP2.ApiModels.Generated.Models.Generated.UserErrorMessage
  references:
  - IMN.Order.Schemas

definitions:

  orderReceived:
    # for now I don't know how to handle the generation of this class
    x-exclude: true
    x-format: Event
    description: |
      This event his a technical one. It is stored in the event hub before it's processed by the OrderActor.
      The order actor will create business event like order created or updated.
      OrderReceived will be not be stored in the Event Store.
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderMarketplaceInfo'

  orderCreated:
    # for now I don't know how to handle the generation of this class
    x-exclude: true
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderMarketplaceInfo'

  orderUpdated:
    # for now I don't know how to handle the generation of this class
    x-exclude: true
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderMarketplaceInfo'

  orderMerchantInfoConfigured:
    x-format: Event
    type: object
    required:
    - order
    - merchantInfo
    properties:
      order:
        $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderIdentifier'
      merchantInfo:
        $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderMerchantInfo'

  orderMerchantInfoCleared:
    x-format: Event
    type: object
    required:
    - order
    properties:
      order:
        $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderIdentifier'

  orderChangeEventBase:
    x-exclude: true
    allOf:
    #- $ref: 'https://api.swaggerhub.com/domains/IMN/imn.io/v1#/definitions/eventBase'
    - type: object
      required:
      - order
      - userId
      - userName
      - ipAddress
      - testMode
      - sourceType
      properties:
        order:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderIdentifier'
        userId:
          $ref: 'https://api.swaggerhub.com/domains/IMN/imn.io/v1#/definitions/userId'
        userName:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderChangeUserName'
        ipAddress:
          description: The IP address who request this operation
          type: string
          example: '127.0.0.1'
        testMode:
          description: This operation was a test
          type: boolean
          example: false
        sourceType:
          $ref: 'https://api.swaggerhub.com/domains/IMN/imn.io/v1#/definitions/operationSourceType'

  orderAccepted:
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-events/1.0#/definitions/orderChangeEventBase'

  orderRefused:
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-events/1.0#/definitions/orderChangeEventBase'

  orderShipped:
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-events/1.0#/definitions/orderChangeEventBase'
    - type: object
      required:
      - order
      - userId
      - userName
      - carrierCode
      - trackingNumber
      - ipAddress
      - testMode
      - sourceType
      properties:
        carrierCode:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/carrierCode'
        trackingNumber:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/trackingNumber'

  orderShippedWithTrackingUrl:
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-events/1.0#/definitions/orderChangeEventBase'
    - type: object
      required:
      - order
      - userId
      - userName
      - carrierName
      - trackingNumber
      - trackingUrl
      - ipAddress
      - testMode
      - sourceType

      properties:
        carrierName:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/carrierName'
        trackingNumber:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/trackingNumber'
        trackingUrl:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/trackingUrl'

  orderRefunded:
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-events/1.0#/definitions/orderChangeEventBase'
    - type: object
      required:
      - order
      - userId
      - userName
      - refundReason
      - ipAddress
      - testMode
      - sourceType
      properties:
        refundReason:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/refundReason'

  orderCancelled:
    x-format: Event
    allOf:
    - $ref: 'https://api.swaggerhub.com/domains/IMN/order-events/1.0#/definitions/orderChangeEventBase'
    - type: object
      required:
      - order
      - userId
      - userName
      - cancellationReason
      - ipAddress
      - testMode
      - sourceType
      properties:
        cancellationReason:
          $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/cancellationReason'

  orderChangeCompleted:
    x-format: Event
    type: object
    required:
    - order
    - status
    properties:
      order:
        $ref: 'https://api.swaggerhub.com/domains/IMN/order-schemas/1.0#/definitions/orderIdentifier'
      status:
        $ref: 'https://api.swaggerhub.com/domains/IMN/imn.io/v1#/definitions/processingStatus'
      error:
        $ref: 'https://api.swaggerhub.com/domains/IMN/imn.io/v1#/definitions/userErrorMessage'